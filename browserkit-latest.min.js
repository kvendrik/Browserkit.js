/*
// @name: Browserkit.js
// @version: 1.1
// 
// Copyright 2014 Koen Vendrik, http://kvendrik.com
// Licensed under the MIT license
*/////////POLYFILLS////////
//Array.indexOf
typeof Array.prototype.indexOf!="function"&&(Array.prototype.indexOf=function(e){for(var t=0,n=this.length;t<n;t++)if(this[t]===e)return t;return-1});if(typeof document.querySelector!="function"){var _querySelectorBase=function(e,t){var t=t!==undefined&&t!==0?1:0,n=function(e,n,r,i){if(i!==undefined&&i!==0){var s=document.getElementsByTagName(e);return s!==undefined?t===1?s:s[0]:null}var o=e.split(n),u=o[0]===""?"*":o[0],a=o[1],f=document.getElementsByTagName(u),l;r==="class"?l=function(e){return e.className.split(" ").indexOf(a)!==-1?1:0}:l=function(e){return e.getAttribute(r)===a?1:0};if(t===1)var c=[];for(var h=f.length-1;h>=0;h--){var s=f[h];if(l(s)===1){if(t===0)return s;c.push(s);continue}}return t===1&&c.length>0?c:null},r=e.indexOf("#"),i=e.indexOf(".");return r!==-1?r===0?document.getElementById(e.replace("#","")):n(e,"#","id"):i!==-1?i===0?n(e,".","class"):n(e,".","class"):n(e,"","",1)};document.querySelector=function(e){return _querySelectorBase(e,0)};document.querySelectorAll=function(e){return _querySelectorBase(e,1)}}typeof document.getElementsByClassName!="function"&&(document.getElementsByClassName=function(e){var t=document.getElementsByTagName("*"),n=[];for(var r=0,i=t.length;r<i;r++)t[r].className.split(" ").indexOf(e)!==-1&&n.push(t[r]);return n});(function(){this.Browserkit=function(e){if(this===window||typeof this._ClassesBase!="function")return new Browserkit(e);var t=typeof e,e;t==="object"?this.el=e:t==="string"&&(this.el=document.querySelector(e));return this};this.Browserkit.prototype._ClassesBase=function(e,t,n){var r=e.className.split(" ");if(n===1)r.push(t);else{var i=r.indexOf(t);i!==-1&&r.splice(i,1)}e.className=r.join(" ")};this.Browserkit.prototype.hasClass=function(e){return this.el.className.split(" ").indexOf(e)!==-1?this:0};this.Browserkit.prototype.addClass=function(e){this.hasClass(e)===0&&this._ClassesBase(this.el,e,1);return this};this.Browserkit.prototype.removeClass=function(e){this.hasClass(e)!==0&&this._ClassesBase(this.el,e,0);return this};this.Browserkit.prototype.toggleClass=function(e){this.hasClass(e)!==0?this.removeClass(e):this.addClass(e);return this};if(typeof window.addEventListener=="function"){this.Browserkit.prototype.addEvent=function(e,t){this.el.addEventListener(e,t,!1);return this};this.Browserkit.prototype.detachEvent=function(e,t){this.el.removeEventListener(e,t,!1);return this}}else if(typeof window.attachEvent=="function"){this.Browserkit.prototype.addEvent=function(e,t){this.el.attachEvent("on"+e,t,!1);return this};this.Browserkit.prototype.detachEvent=function(e,t){this.el.detachEvent("on"+e,t,!1);return this}}else{this.Browserkit.prototype.addEvent=function(e,t){this.el["on"+e]=t;return this};this.Browserkit.prototype.detachEvent=function(e,t){this.el["on"+e]=null;return this}}typeof window.FastButton=="function"?this.Browserkit.prototype.click=function(e){new FastButton(this.el,e);return this}:this.Browserkit.prototype.click=function(e){this.addEvent("click",e);return this};this.Browserkit.prototype.resizeEnd=function(e){this.addEvent("resize",function(){typeof this.resizeEndTimeout!==undefined&&clearTimeout(this.resizeEndTimeout);this.resizeEndTimeout=setTimeout(e,200)});return this};this.Browserkit.prototype.serialize=function(){var e=this.el,t=e.getElementsByTagName("input"),n=e.getElementsByTagName("textarea"),r="";for(var i=t.length-1;i>=0;i--){var s=t[i],o=s.getAttribute("type");o==="radio"||o==="checkbox"?s.getAttribute("checked")!==null&&(r+=s.name+"="+s.value+"&"):r+=s.name+"="+s.value+"&"}for(var i=n.length-1;i>=0;i--){var u=n[i];r+=u.name+"="+u.value+"&"}r=r.slice(0,-1);return r};this.Browserkit.ajax=function(e){var t;typeof window.XMLHttpRequest=="function"||typeof window.XMLHttpRequest=="object"?t=new XMLHttpRequest:t=new ActiveXObject("Microsoft.XMLHTTP");t.onreadystatechange=function(){if(t.readyState===4&&t.status===200){var n=t.responseText,r;e.dataType==="json"?r=this.Browserkit.parseJSON(n):r=n;e.success(r)}};t.open("POST",e.url,!0);t.setRequestHeader("Content-type","application/x-www-form-urlencoded");t.send(e.data)};typeof JSON!="object"||typeof JSON.parse!="function"?this.Browserkit.parseJSON=function(e){e=e.replace("{","").replace("}","").replace(/\"/g,"");var t=e.split(","),n={};for(var r=t.length-1;r>=0;r--){var i=t[r].split(":");n[i[0]]=i[1]}return n}:this.Browserkit.parseJSON=function(e){return JSON.parse(e)};this.B=Browserkit})(this);